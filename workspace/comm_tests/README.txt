

以下にLWIPを用いた通信のサンプルの内容と、ビルド・実行方法を示します。

■SCENE内容と実行方法

- SCENE_1
配置：tcp1
内容：マイコン側をサーバーとしコネクション確立を確認
実行方法：
１．マイコンの電源を投入
２．PC側からマイコンのサーバーへTCP接続を行う．
	接続先：設定１（下記参照）
３．PC側にて接続→切断が行われたことを確認する．
４. 結果を確認する．(確認方法は下記参照)
	
	
- SCENE_2
配置：tcp2
内容：マイコン側をクライアントとしサーバーへの接続の確認．
実行方法：
１．PC側のサーバーの確立
	サーバー：設定２（下記参照）
２．マイコンの電源投入
３．PC側にて接続→切断が行われたことを確認する．
４. 結果を確認する．(確認方法は下記参照)


- SCENE_3
配置：tcp3
内容：TCP通信によるデータの送信（マイコン側をサーバーとする）
実行方法：
１．マイコンの電源を投入
２．PC側からマイコンのサーバーへTCP接続を行う．
	接続先：設定１（下記参照）
３．PC側で受信データを確認する．
	受信データ内容："sample lwip scene3\n"
４. 結果を確認する．(確認方法は下記参照)


- SCENE_4
配置：tcp4
内容：TCP通信によるデータの受信（マイコン側をサーバーとする）
実行方法：
１．マイコンの電源を投入
２．PC側からマイコンのサーバーへTCP接続を行う．
	接続先：設定１（下記参照）
３．PC側から任意の文字列（50文字未満）の送信する．
	シリアルログ出力内容：
４. 結果を確認する．(確認方法は下記参照)
５．マイコン側にて受信した文字列を出力するシリアルログを確認する．
	出力内容：" recv size:〈文字数〉 , recv data:〈送信文字列〉"


- SCENE_7
配置：tcp7
内容：マイコン側をサーバーとし、一度コネクションを確立後切断、その後、再度コネクションを確立できることを確認する
実行方法：
１．マイコンの電源を投入
２．PC側からマイコンのサーバーへTCP接続を行う．
	接続先：設定１（下記参照）
３．PC側にて接続→切断が行われたことを確認する．
４．PC側からマイコンのサーバーへTCP接続を行う．
	接続先：２と同様
５．PC側にて接続→切断が行われたことを確認する．
６. 結果を確認する．(確認方法は下記参照)


- SCENE_8
配置：tcp8
内容：マイコン側をクライアントとし、一度サーバーへの接続を切断、その後、再度サーバーへの接続ができることを確認する
実行方法：
１．PC側のサーバーの確立
	サーバー：設定２（下記参照）
２．マイコンの電源投入
３．PC側にて接続→切断が行われたことを確認する．
４．PC側にてもう一度、接続→切断が行われたことを確認する．
５. 結果を確認する．(確認方法は下記参照)


■IPアドレス／ポート設定

‐設定１
IPアドレス：192.168.11.2
ポート番号：54001

マイコンのIPアドレスは、以下で設定を行っている．
asp-stm32f767/application/src/lwip.c
MX_LWIP_Init関数
IP_ADDRESS[] 配列

ポート番号は、以下で設定を行っている．
asp-stm32f767/sample/tcp_comm/sample_lwip_comm.h
#define SAMPLE_LWIP_SERVER_PORT


- 設定２
IPアドレス：192.168.11.4
ポート番号：54002

IPアドレス／ポート番号は、以下で設定を行っている．
asp-stm32f767/sample/tcp_comm/sample_lwip_comm.h
#define SAMPLE_LWIP_CLIENT_IPADDR
#define SAMPLE_LWIP_CLIENT_PORT


■結果確認
以下に結果確認用に出力されるシリアルログを示します．

成功時：
" <ファイル名> <関数名>() line=<行番号> : scene<シーン番号> success"

失敗時：
" <ファイル名> <関数名>() line=<行番号> <エラー発生機能> err:<エラー番号※>"
" <ファイル名> <関数名>() line=<行番号> : scene<シーン番号> <サンプルプログラムのエラー発生個所>"
※エラー番号が存在する場合


■ビルド方法
MINGWにて以下を実行します．

１．任意のSCENEの配置配下のbuildに移動
２．make clean;make を実行




